<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>MQ Simulator Dashboard</title>
  <link rel="stylesheet" th:href="@{/css/style.css}">
  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- SockJS + STOMP -->
  <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
  <script th:src="@{/js/app.js}"></script>
</head>
<body>
  <header>
    <h1>MQ Simulator</h1>
    <div class="theme-toggle">
      <label>
        <input id="themeCheckbox" type="checkbox" /> Dark theme
      </label>
    </div>
  </header>

  <main>
    <section class="controls">
      <form action="/createQueue" method="post" class="inline">
        <input name="name" placeholder="Queue name" required />
        <input name="type" placeholder="Type" value="FIFO" />
        <input name="capacity" placeholder="Capacity" value="200" />
        <button>Create Queue</button>
      </form>

      <div class="select-queue">
        <label>Select queue:</label>
        <select id="queueSelect" onchange="onQueueChange()">
          <option th:each="q : ${queues}"
                  th:value="${q.name}"
                  th:text="${q.name}"></option>
        </select>
      </div>
    </section>

    <section class="info">
      <div>
        <h3>Queue Info</h3>
        <p><strong>Name:</strong> <span id="qName">-</span></p>
        <p><strong>Type:</strong> <span id="qType">-</span></p>
        <p><strong>Capacity:</strong> <span id="qCap">-</span></p>
        <p><strong>Status:</strong> <span id="qStatus">-</span></p>
        <p><strong>Depth:</strong> <span id="qDepth">-</span></p>

        <form id="statusForm" action="/status" method="post">
          <input type="hidden" name="queue" id="statusQueue" />
          <select name="status" id="statusSelect">
            <option>ACTIVE</option>
            <option>PAUSED</option>
            <option>ERROR</option>
          </select>
          <button type="submit">Set Status</button>
        </form>
      </div>

      <div>
        <h3>Actions</h3>
        <form action="/enqueue" method="post" id="enqueueForm">
          <input type="hidden" name="queue" id="enqueueQueue" />
          <input name="payload" placeholder="Message payload" required />
          <button>Enqueue</button>
        </form>

        <form action="/dequeue" method="post" id="dequeueForm">
          <input type="hidden" name="queue" id="dequeueQueue" />
          <button>Dequeue</button>
        </form>

        <form action="/clear" method="post" id="clearForm">
          <input type="hidden" name="queue" id="clearQueue" />
          <button class="danger">Clear Queue</button>
        </form>

        <form action="/dump" method="post" id="dumpForm">
          <input type="hidden" name="queue" id="dumpQueue" />
          <button>Dump Queue</button>
        </form>
      </div>
    </section>

    <section class="chart-section">
      <h3>Queue Depth (real-time)</h3>
      <canvas id="depthChart" width="800" height="250"></canvas>
    </section>

    <section class="dump">
      <h3>Queue Dump</h3>
      <pre id="dumpArea">No data yet</pre>
    </section>
  </main>
</body>
</html>
